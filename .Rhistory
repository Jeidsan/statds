fill = "grey",
color = "grey30"
) +
labs(
title = bquote(bold("Figura 4.1:")~"Distribuição dos salários conforme estado civil"),
x = "Estado Civil",
y = "Salário"
) +
tema
empresa %>%
statds_summarise(salario, instrucao) %>%
kable(
format = "pipe",
caption = "**Tabela 4.2:** Medidas de resumo para a variável `Salário` , conforme `Grau de Instrução`",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
empresa %>%
ggplot(aes(instrucao, salario)) +
stat_boxplot(
geom = "errorbar",
width = 0.2
) +
geom_boxplot(
fill = "grey",
color = "grey30"
) +
labs(
title = bquote(bold("Figura 4.2:")~"Distribuição dos salários conforme grau de instrução"),
x = "Grau de instrução",
y = "Salário"
) +
tema
1-(13.19167/21.04477)
View(empresa)
table(empresa$estado, empresa$regiao)
empresa %>%
group_by(estado, regiao) %>%
count()
empresa %>%
group_by(estado, regiao) %>%
count() %>%
spread(regiao)
empresa %>%
group_by(estado, regiao) %>%
count() %>%
spread(regiao, n)
empresa %>%
group_by(estado, regiao) %>%
count() %>%
spread(regiao, n)
library(gmodels)
?tally
empresa %>%
group_by(estado, regiao) %>%
tally() %>%
spread(regiao, n)
empresa %>%
group_by(estado, regiao) %>%
count() %>%
spread(regiao, n)
?tabyl
xtabs(~ estado + regiao, data = empresa)
empresa %>%
group_by(estado, regiao) %>%
count()
empresa %>%
group_by(estado, regiao) %>%
count() %>%
bind_rows(
group_by(., estado) %>%
summarise(n = sum(n))
)
empresa %>%
group_by(estado, regiao) %>%
count() %>%
bind_rows(
group_by(., estado) %>%
summarise(n = sum(n)) %>%
mutate(regiao = "Total")
)
empresa %>%
group_by(estado, regiao) %>%
count() %>%
bind_rows(
group_by(., estado) %>%
summarise(n = sum(n)) %>%
mutate(regiao = "Total")
) %>%
spread(regiao, n)
empresa %>%
group_by(estado, regiao) %>%
count() %>%
bind_rows(
group_by(., estado) %>%
summarise(n = sum(n)) %>%
mutate(regiao = "Total")
) %>%
bind_rows(
group_by(., regiao) %>%
summarise(n = sum(n)) %>%
mutate(estado = "Total")
) %>%
spread(regiao, n)
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(x = "Total")
) %>%
bind_rows(
group_by(., !!y) %>%
summarise(n = sum(n)) %>%
mutate(x = "Total")
) %>%
spread(!!y, n)
}
statds_crosstable(empresa, estado, regiao)
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(x = "Total")
) %>%
bind_rows(
group_by(., !!y) %>%
summarise(n = sum(n)) %>%
mutate(y = "Total")
) %>%
spread(!!y, n)
}
statds_crosstable(empresa, estado, regiao)
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(!!x = "Total")
statds_crosstable(empresa, estado, regiao)
x <- enquo(empresa)
x
!!x
x <- enquo(estado)
x <- enquo("estado")
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(!!x = "Total")
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(!!y = "Total")
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(y = "Total")
) %>%
bind_rows(
group_by(., !!y) %>%
summarise(n = sum(n)) %>%
mutate(x = "Total")
) %>%
spread(!!y, n)
}
statds_crosstable(empresa, estado, regiao)
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(!!y = "Total")
?enquo
eval(x)
expr(x)
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(expr(y) = "Total")
?`!!`
empresa %>%
group_by(estado, regiao) %>%
count() %>%
bind_rows(
group_by(., estado) %>%
summarise(n = sum(n))
) %>%
bind_rows(
group_by(., regiao) %>%
summarise(n = sum(n))
) %>%
spread(regiao, n)
empresa %>%
group_by(estado, regiao) %>%
count() %>%
bind_rows(
group_by(., estado) %>%
summarise(n = sum(n))
) %>%
bind_rows(
group_by(., regiao) %>%
summarise(n = sum(n))
)
empresa %>%
group_by(estado, regiao) %>%
count() %>%
bind_rows(
group_by(., estado) %>%
summarise(n = sum(n))
) %>%
bind_rows(
group_by(., regiao) %>%
summarise(n = sum(n)) %>%
mutate(estado = "Total")
)
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(!!y = "Total")
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(!!y = "Total")
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(!!y = "Total")
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(!!y = 'Total')
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(!!y = 'Total')
statds_crosstable(empresa, estado, regiao)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(regiao = 'Total')
) %>%
bind_rows(
group_by(., !!y) %>%
summarise(n = sum(n)) %>%
mutate(estado = 'Total')
) %>%
spread(!!y, n)
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(regiao = 'Total')
) %>%
bind_rows(
group_by(., !!y) %>%
summarise(n = sum(n)) %>%
mutate(estado = 'Total')
) %>%
spread(!!y, n)
}
statds_crosstable(empresa, estado, regiao)
empresa %>%
group_by(estado, regiao) %>%
count() %>%
bind_rows(
group_by(., estado) %>%
summarise(n = sum(n)) %>%
mutate(regiao = "Total")
) %>%
bind_rows(
group_by(., regiao) %>%
summarise(n = sum(n)) %>%
mutate(estado = "Total")
) %>%
spread(regiao, n)
empresa %>%
group_by(estado, regiao) %>%
count() %>%
bind_rows(
group_by(., estado) %>%
summarise(n = sum(n)) %>%
mutate(regiao = "Total")
) %>%
bind_rows(
group_by(., regiao) %>%
summarise(n = sum(n)) %>%
mutate(estado = "Total")
) %>%
spread(regiao, n) %>%
kable(
format = "pipe",
caption = "**Tabela 4.1:** Distribuição conjunta das variáveis Estado Civil e Região de Procedência",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
?pchisq
chisq.test(empresa$estado, empresa$regiao)
x <- chisq.test(empresa$estado, empresa$regiao)
x$observed
x$statistic
class(x$statistic)
x$statistic[[1]]
x$statistic[1]
chisq <- chisq.test(empresa$estado, empresa$regiao)
qui_quadrado <- chisq.test(empresa$estado, empresa$regiao)
chisq.test(empresa$estado, empresa$regiao)$statistic
qui_quadrado <- chisq.test(empresa$estado, empresa$regiao)$statistic[[1]]
qui_quadrado
length(empresa)
nrow(empresa)
c <- sqrt(qui_quadrado / (qui_quadrado + n))
c
?calc.TT
qui_quadrado <- chisq.test(empresa$estado, empresa$regiao)$statistic[[1]]
n <- nrow(empresa)
c <- sqrt(qui_quadrado / (qui_quadrado + n))
empresa %>%
group_by(instrucao, regiao) %>%
count() %>%
bind_rows(
group_by(., instrucao) %>%
summarise(n = sum(n)) %>%
mutate(regiao = "Total")
) %>%
bind_rows(
group_by(., regiao) %>%
summarise(n = sum(n)) %>%
mutate(instrucao = "Total")
) %>%
spread(regiao, n) %>%
kable(
format = "pipe",
caption = "**Tabela 4.2:** Distribuição conjunta das variáveis Grau de Instrução e Região de Procedência",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
qui_quadrado <- chisq.test(empresa$instrucao, empresa$regiao)$statistic[[1]]
n <- nrow(empresa)
c <- sqrt(qui_quadrado / (qui_quadrado + n))
qui_quadrado
c
empresa %>%
statds_summarise(salario, regiao) %>%
kable(
format = "pipe",
caption = "**Tabela 4.3:** Medidas de resumo para a variável `Salário`, conforme `Região de procedência`",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
empresa %>%
ggplot(aes(regiao, salario)) +
stat_boxplot(
geom = "errorbar",
width = 0.2
) +
geom_boxplot(
fill = "grey",
color = "grey30"
) +
labs(
title = bquote(bold("Figura 4.1:")~"Distribuição dos salários conforme região de procedência"),
x = "Região de Procedência",
y = "Salário"
) +
tema
((12*28.05) + (11*29.99) + (13*9.89))/(12+11+13)
var(empresa$salario)
1 - (22.085/21.04477)
a <- mean(empresa$salario)
a
b <- empresa$salario - a
b
b^2
sum(b^2)
sum(b^2) / length(b)
sum(b^2) / (length(b) - 1)
sum(b^2) / length(b)
var(empresa$salario)
?var
var(empresa$salario, empresa$regiao)
var(empresa$salario, empresa$salario)
x <- empresa %>% filter(regiao == "interior")
var(x$salario)
empresa %>%
statds_summarise(salario, regiao) %>%
kable(
format = "pipe",
caption = "**Tabela 4.3:** Medidas de resumo para a variável `Salário`, conforme `Região de procedência`",
label = NA,
digits = 5,
align = "c",
format.args = list(decimal.mark = ",")
)
x <- empresa %>%
statds_summarise(salario, regiao)
x
x$Variância
a <- x$Variância * x$n
sum(a)
b <- sum(a) / sum(x$n)
b
1 - (b/var(empresa$salario))
empresa %>%
statds_summarise(salario, regiao) %>%
kable(
format = "pipe",
caption = "**Tabela 4.3:** Medidas de resumo para a variável `Salário`, conforme `Região de procedência`",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
empresa %>%
ggplot(aes(regiao, salario)) +
stat_boxplot(
geom = "errorbar",
width = 0.2
) +
geom_boxplot(
fill = "grey",
color = "grey30"
) +
labs(
title = bquote(bold("Figura 4.1:")~"Distribuição dos salários conforme região de procedência"),
x = "Região de Procedência",
y = "Salário"
) +
tema
