) +
labs(
title = bquote(bold("Figura 3.68:")~"Consumo de oxigênio durante teste de esforço"),
x = "Momento do teste",
y = "Consumo de oxigênio - ml/(kg.min)"
) +
tema
resumo <- vo2 %>%
group_by(Momento) %>%
summarise(
`Média` = mean(vo2, na.rm = TRUE),
`Desvio Padrão` = sd(vo2, na.rm = TRUE),
Q1 = quantile(vo2, 0.25, na.rm = TRUE)[[1]],
`Mediana` = median(vo2, na.rm = TRUE),
Q3 = quantile(vo2, 0.75, na.rm = TRUE)[[1]],
`Distância Interquartil` = IQR(vo2, na.rm = TRUE)
) %>%
arrange(factor(Momento, level = c("Repouso", "Limiar anaeróbico", "Ponto de Compensação", "Pico")))
resumo %>%
kable(
format = "pipe",
caption = "**Tabela 3.11:** Consumo de oxigênio por momento de avaliação",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
View(vo2)
resumo
resumo %>%
mutate(
limite = Q3 + 1.5 * `Distância Interquartil`
)
resumo <- resumo %>%
mutate(
limite = Q3 + 1.5 * `Distância Interquartil`
)
resumo
vo2
resumo
vo2 %>%
filter(vo2 > resumo[,Momento == Momento]$limite)
vo2 %>%
filter(vo2 > resumo[ , resumo$Momento == Momento]$limite)
vo2 %>%
filter(
vo2 > resumo %>%
filter(Momento == Momento) %>%
select(limite)
)
resumo <- resumo %>%
transmute(
m = Momento,
l = Q3 + 1.5 * `Distância Interquartil`
)
resumo
resumo2 <- resumo %>%
transmute(
m = Momento,
l = Q3 + 1.5 * `Distância Interquartil`
)
resumo <- vo2 %>%
group_by(Momento) %>%
summarise(
`Média` = mean(vo2, na.rm = TRUE),
`Desvio Padrão` = sd(vo2, na.rm = TRUE),
Q1 = quantile(vo2, 0.25, na.rm = TRUE)[[1]],
`Mediana` = median(vo2, na.rm = TRUE),
Q3 = quantile(vo2, 0.75, na.rm = TRUE)[[1]],
`Distância Interquartil` = IQR(vo2, na.rm = TRUE)
) %>%
arrange(factor(Momento, level = c("Repouso", "Limiar anaeróbico", "Ponto de Compensação", "Pico")))
resumo %>%
kable(
format = "pipe",
caption = "**Tabela 3.11:** Consumo de oxigênio por momento de avaliação",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
resumo2 <- resumo %>%
transmute(
m = Momento,
l = Q3 + 1.5 * `Distância Interquartil`
)
resumo2
vo2 %>%
filter(
vo2 > resumo %>%
filter(m == Momento) %>%
select(l)
)
x = Repouso
x = "Repouso"
resumo2 %>%
filter(l == x)$l
filter(resumo2, l == x)$l
filter(resumo2, l == x)$l[[1]]
filter(resumo2, l == x)
filter(resumo2, m == x)
filter(resumo2, m == x)$l
get_limit <- function(x) {
filter(resumo2, m == x)$l
}
get_limit <- function(x) {
filter(resumo2, m == x)$l
}
vo2 %>%
filter(vo2 > get_limit(Momento))
vo2 %>%
filter(vo2 > get_limit(Momento))
vo2 %>%
left_join(select(resumo, by = "Momento"))
vo2 %>%
inner_join(select(resumo, by = "Momento"))
vo2 %>%
inner_join(resumo, by = "Momento")
vo2 %>%
inner_join(resumo2, by = join_by(Momento == m))
vo2 %>%
left_join(resumo2, by = join_by(Momento == m))
vo2 %>%
inner_join(resumo2, by = join_by(Momento == m))
vo2 %>%
left_join(resumo2, by = join_by(Momento == m))
vo2 %>%
left_join(resumo2, by = join_by(Momento == m)) %>%
filter(vo2 > l)
vo2 %>%
left_join(resumo2, by = join_by(Momento == m)) %>%
filter(vo2 > l) %>%
unique(id)
vo2 %>%
left_join(resumo2, by = join_by(Momento == m)) %>%
filter(vo2 > l) %>%
select(id)
vo2 %>%
left_join(resumo2, by = join_by(Momento == m)) %>%
filter(vo2 > l) %>%
select(id) %>%
distinct()
vo2 %>%
left_join(resumo2, by = join_by(Momento == m)) %>%
filter(vo2 > l) %>%
select(id) %>%
distinct()$id
(vo2 %>%
left_join(resumo2, by = join_by(Momento == m)) %>%
filter(vo2 > l) %>%
select(id) %>%
distinct())$id
vo2 %>%
left_join(resumo2, by = join_by(Momento == m)) %>%
filter(vo2 > l) %>%
select(id) %>%
distinct() %>%
as.array()
vo2 %>%
left_join(resumo2, by = join_by(Momento == m)) %>%
filter(vo2 > l) %>%
select(id) %>%
distinct() %>%
array()
esforco <- readxl::read_xls(paste0(data_dir, "esforco.xls"), sheet = "dados", skip = 3, col_names = FALSE)
colnames(esforco) <- c(
"id_grupo", "iniciais", "etiologia", "sexo", "data_espirometrico",
"idade", "altura", "peso", "superficie_corporal", "imc",
"nyha", "weber", "fc_rep", "vo2_rep", "rer_rep", "vo2_fc_rep",
"ve_vo2_rep", "ve_vco2_rep", "aumento_carga_rep", "teste_maximo_rep",
"carga_lan", "perc_max_carga_lan", "fc_lan", "vo2_lan",
"perc_max_vo2_lan", "rer_lan", "perc_max_rer_lan", "vo2_fc_lan",
"perc_max_vo2_fc_lan", "ve_vo2_lan", "perc_max_ve_vo2_lan",
"ve_vco2_lan", "perc_max_ve_vco2_lan", "carga_pcr", "perc_max_carga_pcr",
"fc_pcr", "vo2_pcr", "perc_max_vo2_pcr", "rer_pcr", "perc_max_rer_pcr",
"vo2_fc_pcr", "perc_max_vo2_fc_pcr", "ve_vo2_pcr", "perc_max_ve_vo2_pcr",
"ve_vco2_pcr", "perc_max_ve_vco2_pcr", "carga_w", "fc_w",
"vo2_w", "rer_w", "vo2_fc_w", "ve_vo2_w", "ve_vco2_w",
"tempo_rampa", "vo2_wr_slope", "ve_vco2_slope", "data_obito",
"data_ultima_obs", "cirurgia"
)
map_etiologia <- function(x) {
x %>%
str_replace("CH\\b", "Chagasíaco") %>%
str_replace("ID\\b", "Idiopático") %>%
str_replace("IS\\b", "Isquêmico") %>%
str_replace("C\\b", "Controle")
}
map_sexo <- function(x) {
x %>%
str_replace("M", "Masculino") %>%
str_replace("F", "Feminino")
}
map_sim_nao_na <- function(x) {
x %>%
str_replace("S", "Sim") %>%
str_replace("N", "Não") %>%
str_replace("\\.", NA_character_)
}
esforco <- esforco %>%
mutate(
id = ifelse(etiologia == 'C', id_grupo + 87, id_grupo),
grupo = parse_factor(ifelse(etiologia == 'C', "Controle", "Caso")),
id_grupo = as.integer(id_grupo),
etiologia = parse_factor(map_etiologia(etiologia)),
sexo = parse_factor(map_sexo(sexo)),
data_espirometrico = dmy(data_espirometrico),
idade = as.integer(idade),
altura = as.integer(altura),
nyha = parse_factor(as.character(nyha), levels = c("1", "2", "3", "4"), ordered = TRUE, na = "0"),
weber = parse_factor(weber, levels = c("A", "B", "C", "D", "E", NA), ordered = TRUE),
teste_maximo_rep = parse_factor(map_sim_nao_na(teste_maximo_rep)),
carga_lan = parse_integer(carga_lan, na = "."),
perc_max_carga_lan = parse_double(perc_max_carga_lan, na = "."),
fc_lan = parse_double(fc_lan, na = "."),
vo2_lan = parse_double(vo2_lan, na = "."),
perc_max_vo2_lan = parse_double(perc_max_vo2_lan, na = "."),
rer_lan = parse_double(rer_lan, na = "."),
perc_max_rer_lan = parse_double(perc_max_rer_lan, na = "."),
vo2_fc_lan = parse_double(vo2_fc_lan, na = "."),
perc_max_vo2_fc_lan = parse_double(perc_max_vo2_fc_lan, na = "."),
ve_vo2_lan = parse_double(ve_vo2_lan, na = "."),
perc_max_ve_vo2_lan = parse_double(perc_max_ve_vo2_lan, na = "."),
ve_vco2_lan = parse_double(ve_vco2_lan, na = "."),
perc_max_ve_vco2_lan = parse_double(perc_max_ve_vco2_lan, na = "."),
carga_pcr = parse_double(carga_pcr, na = "."),
perc_max_carga_pcr = parse_double(perc_max_carga_pcr, na = "."),
fc_pcr = parse_double(fc_pcr, na = "."),
vo2_pcr = parse_double(vo2_pcr, na = "."),
perc_max_vo2_pcr = parse_double(perc_max_vo2_pcr, na = "."),
rer_pcr = parse_double(rer_pcr, na = "."),
perc_max_rer_pcr = parse_double(perc_max_rer_pcr, na = "."),
vo2_fc_pcr = parse_double(vo2_fc_pcr, na = "."),
perc_max_vo2_fc_pcr = parse_double(perc_max_vo2_fc_pcr, na = "."),
ve_vo2_pcr = parse_double(ve_vo2_pcr, na = "."),
perc_max_ve_vo2_pcr = parse_double(perc_max_ve_vo2_pcr, na = "."),
ve_vco2_pcr = parse_double(ve_vco2_pcr, na = "."),
perc_max_ve_vco2_pcr = parse_double(perc_max_ve_vco2_pcr, na = "."),
carga_w = parse_double(carga_w, na = "."),
tempo_rampa  = parse_double(tempo_rampa, na = "."),
vo2_wr_slope  = parse_double(vo2_wr_slope, na = "."),
data_obito = dmy(data_obito),
data_ultima_obs = dmy(data_ultima_obs)
)
write_csv(esforco, paste0(data_dir, "esforco_completo.csv"))
vo2 <- esforco %>%
select(id, vo2_rep, vo2_lan, vo2_pcr, vo2_w) %>%
gather(vo2_rep, vo2_lan, vo2_pcr, vo2_w, key = "Momento", value = "vo2") %>%
mutate (
Momento = Momento %>%
str_replace("vo2_rep", "Repouso") %>%
str_replace("vo2_lan", "Limiar anaeróbico") %>%
str_replace("vo2_pcr", "Ponto de Compensação") %>%
str_replace("vo2_w", "Pico")
)
head(vo2)
vo2 <- esforco %>%
select(id, grupo, vo2_rep, vo2_lan, vo2_pcr, vo2_w) %>%
gather(vo2_rep, vo2_lan, vo2_pcr, vo2_w, key = "Momento", value = "vo2") %>%
mutate (
Momento = Momento %>%
str_replace("vo2_rep", "Repouso") %>%
str_replace("vo2_lan", "Limiar anaeróbico") %>%
str_replace("vo2_pcr", "Ponto de Compensação") %>%
str_replace("vo2_w", "Pico")
)
head(vo2)
vo2 %>%
ggplot(aes(vo2)) +
geom_histogram(
fill = "grey",
color = "grey30"
) +
facet_wrap(~Momento) +
labs(
title = bquote(bold("Figura 3.67:")~"Consumo de oxigênio durante teste de esforço"),
x = "Consumo de oxigênio - ml/(kg.min)",
y = "Frequência"
) +
tema
vo2 %>%
ggplot(aes(vo2, group = grupo)) +
geom_histogram(
fill = "grey",
color = "grey30"
) +
facet_wrap(~Momento) +
labs(
title = bquote(bold("Figura 3.67:")~"Consumo de oxigênio durante teste de esforço"),
x = "Consumo de oxigênio - ml/(kg.min)",
y = "Frequência"
) +
tema
vo2 %>%
ggplot(aes(vo2, color = grupo)) +
geom_histogram(
fill = "grey",
color = "grey30"
) +
facet_wrap(~Momento) +
labs(
title = bquote(bold("Figura 3.67:")~"Consumo de oxigênio durante teste de esforço"),
x = "Consumo de oxigênio - ml/(kg.min)",
y = "Frequência"
) +
tema
vo2 %>%
ggplot(aes(vo2)) +
geom_histogram(
fill = "grey",
color = "grey30"
) +
facet_wrap(~Momento) +
labs(
title = bquote(bold("Figura 3.67:")~"Consumo de oxigênio durante teste de esforço"),
x = "Consumo de oxigênio - ml/(kg.min)",
y = "Frequência"
) +
tema
vo2 %>%
ggplot(aes(
x = factor(Momento, level = c("Repouso", "Limiar anaeróbico", "Ponto de Compensação", "Pico")),
y = vo2
)) +
stat_boxplot(
geom = "errorbar",
width = 0.2
) +
geom_boxplot(
fill = "grey",
color = "grey30"
) +
labs(
title = bquote(bold("Figura 3.68:")~"Consumo de oxigênio durante teste de esforço"),
x = "Momento do teste",
y = "Consumo de oxigênio - ml/(kg.min)"
) +
tema
resumo <- vo2 %>%
group_by(grupo, Momento) %>%
summarise(
`Média` = mean(vo2, na.rm = TRUE),
`Desvio Padrão` = sd(vo2, na.rm = TRUE),
Q1 = quantile(vo2, 0.25, na.rm = TRUE)[[1]],
`Mediana` = median(vo2, na.rm = TRUE),
Q3 = quantile(vo2, 0.75, na.rm = TRUE)[[1]],
`Distância Interquartil` = IQR(vo2, na.rm = TRUE)
) %>%
arrange(factor(Momento, level = c("Repouso", "Limiar anaeróbico", "Ponto de Compensação", "Pico")))
resumo %>%
kable(
format = "pipe",
caption = "**Tabela 3.11:** Consumo de oxigênio por momento de avaliação",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
resumo <- vo2 %>%
group_by(Momento, grupo) %>%
summarise(
`Média` = mean(vo2, na.rm = TRUE),
`Desvio Padrão` = sd(vo2, na.rm = TRUE),
Q1 = quantile(vo2, 0.25, na.rm = TRUE)[[1]],
`Mediana` = median(vo2, na.rm = TRUE),
Q3 = quantile(vo2, 0.75, na.rm = TRUE)[[1]],
`Distância Interquartil` = IQR(vo2, na.rm = TRUE)
) %>%
arrange(factor(Momento, level = c("Repouso", "Limiar anaeróbico", "Ponto de Compensação", "Pico")))
resumo <- vo2 %>%
group_by(Momento, grupo) %>%
summarise(
`Média` = mean(vo2, na.rm = TRUE),
`Desvio Padrão` = sd(vo2, na.rm = TRUE),
Q1 = quantile(vo2, 0.25, na.rm = TRUE)[[1]],
`Mediana` = median(vo2, na.rm = TRUE),
Q3 = quantile(vo2, 0.75, na.rm = TRUE)[[1]],
`Distância Interquartil` = IQR(vo2, na.rm = TRUE)
) %>%
arrange(factor(Momento, level = c("Repouso", "Limiar anaeróbico", "Ponto de Compensação", "Pico")))
resumo %>%
kable(
format = "pipe",
caption = "**Tabela 3.11:** Consumo de oxigênio por momento de avaliação",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
lampadas <- tribble(
~min, ~max, ~frequencia,
0, 99, 82,
100, 199, 71,
200, 299, 68,
300, 399, 56,
400, 499, 43,
500, 599, 15
)
lampadas <- tribble(
~min, ~max, ~frequencia,
0, 99, 82,
100, 199, 71,
200, 299, 68,
300, 399, 56,
400, 499, 43,
500, 599, 15
)
total <- sum(lampadas$frequencia)
total
lampadas <- tribble(
~min, ~max, ~freq,
0, 99, 82,
100, 199, 71,
200, 299, 68,
300, 399, 56,
400, 499, 43,
500, 599, 15
)
total <- sum(lampadas$freq)
lampadas %>%
mutate(
freq_relativa = freq/total,
freq_acumulado = cumsum(freq)
)
lampadas %>%
mutate(
freq_relativa = freq/sum(freq),
freq_acumulado = cumsum(freq)
)
lampadas %>%
mutate(
freq_acumulado = cumsum(freq),
freq_relativa = freq/sum(freq),
freq_rel_acumulada = cumsum(freq_relativa)
)
lampadas <- lampadas %>%
mutate(
freq_acu = cumsum(freq),
freq_rel = freq/sum(freq),
freq_rel_acu = cumsum(freq_relativa)
)
lampadas <- lampadas %>%
mutate(
freq_acu = cumsum(freq),
freq_rel = freq/sum(freq),
freq_rel_acu = cumsum(freq_rel)
)
lampadas %>%
ggplot(aes(x = min, y = freq)) +
geom_histogram()
lampadas %>%
ggplot(aes(x = min, y = freq)) +
geom_bar()
lampadas %>%
ggplot(aes(x = min, y = freq)) +
geom_col()
lampadas %>%
ggplot(aes(x = (max - min) / 100, y = freq)) +
geom_col()
lampadas %>%
ggplot(aes(x = max, y = freq)) +
geom_col()
lampadas %>%
ggplot(aes(x = min + 50, y = freq)) +
geom_col()
lampadas %>%
ggplot(aes(freq)) +
geom_histogram()
lampadas %>%
ggplot(aes(x = min + 50, y = freq)) +
geom_histogram()
lampadas %>%
ggplot(aes(x = min + 50, y = freq)) +
geom_col(position = "dodge")
lampadas %>%
ggplot(aes(x = min + 50, y = freq)) +
geom_col(position = "identity")
?geom_col
?position_dodge
lampadas %>%
ggplot(aes(x = min + 50, y = freq)) +
geom_col(position = "nudge")
lampadas %>%
ggplot(aes(x = min + 50, y = freq)) +
geom_col(
fill = "grey",
color = "grey30"
) +
labs(
title = bquote(bold("Figura 3.69:")~"Tempo de vida das lâmpadas"),
x = "Tempo de vida (h)",
y = "Frequência observada"
) +
tema
lampadas %>%
ggplot(aes(x = min + 50, y = freq)) +
geom_col(
fill = "grey",
color = "grey30"
) +
scale_x_continuous(
breaks = seq(0, 600, 100)
) +
labs(
title = bquote(bold("Figura 3.69:")~"Tempo de vida das lâmpadas"),
x = "Tempo de vida (h)",
y = "Frequência observada"
) +
tema
lampadas %>%
kable()
lampadas
