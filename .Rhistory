tema
library(tidyverse)
library(knitr)
library(e1071)
library(gridExtra)
data_dir <- paste0(getwd(), "/data/")
options(
repr.plot.width = 24,
repr.plot.height = 13,
knitr.kable.NA = " - "
)
tema <- theme_bw() +
theme(
plot.title   = element_text(size = 12, vjust = +2, hjust = 0.5),
axis.title.y = element_text(size = 10, vjust = +4),
axis.title.x = element_text(size = 10, vjust = -1),
axis.text.y  = element_text(size = 10),
axis.text.x  = element_text(size = 10),
legend.text  = element_text(size = 10),
strip.text   = element_text(size = 10)
)
statds_read <- function(file, type = "csv", ...) {
file <- paste0(data_dir, file)
switch(
type,
"csv" = readr::read_csv(file, ...),
"xls" = readxl::read_xls(file, ...)
)
}
statds_summarise <- function(data, x, ...) {
x <- enquo(x)
data %>%
group_by(...) %>%
summarize(
`n` = n(),
`Média` = mean(!!x, na.rm = TRUE),
`Variância` = var(!!x, na.rm = TRUE),
`Desvio Padrão` = sd(!!x, na.rm = TRUE),
`Min.` = min(!!x),
`Q1` = quantile(!!x, c(0.25), na.rm = TRUE)[[1]],
`Mediana` = median(!!x, na.rm = TRUE),
`Q3` = quantile(!!x, c(0.75), na.rm = TRUE)[[1]],
`Máx.` = max(!!x),
`IQR` = IQR(!!x, na.rm = TRUE)
)
}
statds_crosstable <- function(data, x, y, totals = TRUE) {
x <- enquo(x)
y <- enquo(y)
data %>%
group_by(!!x, !!y) %>%
count() %>%
bind_rows(
group_by(., !!x) %>%
summarise(n = sum(n)) %>%
mutate(regiao = 'Total')
) %>%
bind_rows(
group_by(., !!y) %>%
summarise(n = sum(n)) %>%
mutate(estado = 'Total')
) %>%
spread(!!y, n)
}
regioes <- statds_read("regioes.xls", "xls")
View(regioes)
colnames(regioes) <- c("regiao", "estado", "superficie", "populacao", "densidade")
1 != 2
regiao <- regiao %>%
filter(estado != "Subtot")
regioes <- regioes %>%
filter(estado != "Subtot")
regioes <- regioes %>%
filter(estado != "Subtot") %>%
filter(estado != "Total")
regioes %>% fill(regiao)
regioes <- regioes %>%
filter(estado != "Subtot") %>%
filter(estado != "Total") %>%
fill(regiao)
summary(regioes)
regioes %>%
filter(estado != "Subtot") %>%
filter(estado != "Total") %>%
fill(regiao) %>%
mutate(
regioes = parse_factor(regioes),
estado = parse_factor(estado)
)
regioes <- statds_read("regioes.xls", "xls")
colnames(regioes) <- c("regiao", "estado", "superficie", "populacao", "densidade")
regioes %>%
filter(estado != "Subtot") %>%
filter(estado != "Total") %>%
fill(regiao) %>%
mutate(
regioes = parse_factor(regioes),
estado = parse_factor(estado)
)
regioes %>%
filter(estado != "Subtot") %>%
filter(estado != "Total") %>%
fill(regiao) %>%
mutate(
regiao = parse_factor(regiao),
estado = parse_factor(estado)
)
regioes <- statds_read("regioes.xls", "xls")
colnames(regioes) <- c("regiao", "estado", "superficie", "populacao", "densidade")
regioes <- regioes %>%
filter(estado != "Subtot") %>%
filter(estado != "Total") %>%
fill(regiao) %>%
mutate(
regiao = parse_factor(regiao),
estado = parse_factor(estado)
)
statds_write(data, file, ...) {
statds_write(data, file, ...) {
statds_write <- function(data, file, ...) {
file <- paste0(data_dir, file)
readr::write_csv(file, ...)
}
statds_write(regioes, "regioes.csv")
statds_write <- function(data, file, ...) {
file <- paste0(data_dir, file)
readr::write_csv(data, file, ...)
}
statds_write(regioes, "regioes.csv")
regiao %>%
statds_summarise(densidade, regiao) %>%
kable(
format = "pipe",
caption = "**Tabela 4.4:** Medidas de resumo para a variável `Densidade Populacional`, conforme `Região`",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
regiao %>%
statds_summarise(densidade, regiao) %>%
kable(
format = "pipe",
caption = "**Tabela 4.4:** Medidas de resumo para a variável `Densidade Populacional`, conforme `Região`",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
regioes %>%
statds_summarise(densidade, regiao) %>%
kable(
format = "pipe",
caption = "**Tabela 4.4:** Medidas de resumo para a variável `Densidade Populacional`, conforme `Região`",
label = NA,
digits = 2,
align = "c",
format.args = list(decimal.mark = ",")
)
regioes %>%
ggplot(aes(regiao, densidade)) +
stat_boxplot(
geom = "errorbar",
width = 0.2
) +
geom_boxplot(
fill = "grey",
color = "grey30"
) +
labs(
title = bquote(bold("Figura 4.2:")~"Densidade populacional conforme região"),
x = "Região",
y = "Densidade populacional"
) +
tema
regioes %>%
ggplot(aes(regiao, densidade)) +
stat_boxplot(
geom = "errorbar",
width = 0.2
) +
labs(
title = bquote(bold("Figura 4.2:")~"Densidade populacional conforme região"),
x = "Região",
y = "Densidade populacional"
) +
tema
regioes %>%
ggplot(aes(regiao, densidade)) +
stat_boxplot(
geom = "errorbar",
width = 0.2
) +
geom_boxplot(
fill = "grey",
color = "grey30"
) +
labs(
title = bquote(bold("Figura 4.2:")~"Densidade populacional conforme região"),
x = "Região",
y = "Densidade populacional"
) +
tema
salarios <- statds_read("salarios.xls", "xls")
View(salarios)
salarios <- statds_read("salarios.xls", "xls", skip = 4)
colnames(salarios)
salarios %>%
ggplot(aes(`Prof. Sec.`, `Administrador`)) +
geom_qq() +
geom_qq_line() +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
salarios %>%
ggplot(aes(`Prof. Sec.`, `Administrador`)) +
geom_qq() +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
colnames(salarios) <- c("cidade", "prof_sec", "mecanico","administrador","eng_eletr")
salarios %>%
ggplot(aes(prof_sec, administrador)) +
geom_qq() +
geom_qq_line() +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
geom_qq
statds_qq <- function(x, y, ...) {
x <- unquo(x)
y <- unquo(y)
quantiles <- seq(0, 1, 0,01)
quantile_x <- quantile(.$x)
quantile_y <- quantile(.$y)
geom_point(aes(quantile_x, quantile_y), ...) +
geom_line(aes(slope = 1, intercept = 0))
}
salarios %>%
ggplot() +
statds_qq()
statds_qq <- function(x, y, ...) {
x <- enquo(x)
y <- enquo(y)
quantiles <- seq(0, 1, 0,01)
quantile_x <- quantile(.$x)
quantile_y <- quantile(.$y)
geom_point(aes(quantile_x, quantile_y), ...) +
geom_line(aes(slope = 1, intercept = 0))
}
salarios %>%
ggplot() +
statds_qq()
statds_qq <- function(x, y, ...) {
x <- enquo(x)
y <- enquo(y)
quantiles <- seq(0, 1, 0.01)
quantile_x <- quantile(.$x)
quantile_y <- quantile(.$y)
geom_point(aes(quantile_x, quantile_y), ...) +
geom_line(aes(slope = 1, intercept = 0))
}
salarios %>%
ggplot() +
statds_qq()
ggplot(aes(quantile_prof_sec, quantile_administrador)) +
geom_point() +
geom_line(aes(slope = 1, intercept = 0), linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
salarios %>%
ggplot(aes(quantile_prof_sec, quantile_administrador)) +
geom_point() +
geom_line(aes(slope = 1, intercept = 0), linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
salarios %>%
ggplot(aes(quantile_prof_sec, quantile_administrador)) +
geom_point() +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
quantiles <- seq(0, 1, 0.1)
quantiles_prof_sec <- quantile(salarios$prof_sec, quantiles)
quantiles_administrador <- quantile(salarios$administrador, quantiles)
ggplot(aes(quantile_prof_sec, quantile_administrador)) +
geom_point() +
geom_line(aes(slope = 1, intercept = 0), linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
salarios %>%
ggplot(aes(quantile_prof_sec, quantile_administrador)) +
geom_point() +
geom_line(aes(slope = 1, intercept = 0), linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
salarios %>%
ggplot(aes(quantile_prof_sec, quantile_administrador)) +
geom_point()
ggplot(aes(quantile_prof_sec, quantile_administrador)) +
geom_point()
ggplot(aes(quantiles_prof_sec, quantiles_administrador)) +
geom_point() +
geom_line(aes(slope = 1, intercept = 0), linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
quantiles <- seq(0, 1, 0.1)
quantiles_prof_sec <- quantile(salarios$prof_sec, quantiles)
quantiles_administrador <- quantile(salarios$administrador, quantiles)
ggplot(aes(quantiles_prof_sec, quantiles_administrador)) +
geom_point() +
geom_line(aes(slope = 1, intercept = 0), linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
ggplot(aes(quantiles_prof_sec, quantiles_administrador)) +
geom_point()
salarios %>%
ggplot(aes(quantiles_prof_sec, quantiles_administrador)) +
geom_point()
salarios %>%
ggplot() +
geom_point(aes(quantiles_prof_sec, quantiles_administrador))
salarios %>%
ggplot(aes(
x = quantiles_prof_sec,
y = quantiles_administrador)
) +
geom_point()
salarios %>%
ggplot(
mapping = aes(
x = quantiles_prof_sec,
y = quantiles_administrador
)
) +
geom_point()
ggplot(
mapping = aes(
x = quantiles_prof_sec,
y = quantiles_administrador
)
) +
geom_point()
ggplot(mapping = aes(x = quantiles_prof_sec, y = quantiles_administrador)) +
geom_point() +
geom_line(aes(slope = 1, intercept = 0), linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
ggplot(mapping = aes(x = quantiles_prof_sec, y = quantiles_administrador)) +
geom_point() +
geom_abline(aes(slope = 1, intercept = 0), linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
ggplot(
mapping = aes(
x = quantiles_prof_sec,
y = quantiles_administrador,
slope = 1,
intercept = 0
)
) +
geom_point() +
geom_abline(linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
ggplot(
mapping = aes(
x = quantiles_prof_sec,
y = quantiles_administrador,
slope = 1,
intercept = 0
)
) +
geom_point() +
geom_abline(linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"~a_lab),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
ggplot(
mapping = aes(
x = quantiles_prof_sec,
y = quantiles_administrador,
slope = 1,
intercept = 0
)
) +
geom_point() +
geom_abline(linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"~x_lab),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
ggplot(
mapping = aes(
x = quantiles_prof_sec,
y = quantiles_administrador,
slope = 1,
intercept = 0
)
) +
geom_point() +
geom_abline(linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema
ggplot(
mapping = aes(
x = quantiles_prof_sec,
y = quantiles_administrador,
slope = 1,
intercept = 0
)
) +
geom_point() +
geom_abline(linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema +
coord_cartesian(xlim(0,80000))
ggplot(
mapping = aes(
x = quantiles_prof_sec,
y = quantiles_administrador,
slope = 1,
intercept = 0
)
) +
geom_point() +
geom_abline(linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema +
coord_cartesian(xlim = c(0,80000) )
ggplot(
mapping = aes(
x = quantiles_prof_sec,
y = quantiles_administrador,
slope = 1,
intercept = 0
)
) +
geom_point() +
geom_abline(linetype = 2) +
labs(
title = bquote(bold("Figura 4.3:")~"Quantis entre o salário de professores secundaristas e administradores"),
x = "Prof. Sec.",
y = "Administrador"
) +
tema +
coord_cartesian(xlim = c(0,80000), ylim = c(0,80000) )
